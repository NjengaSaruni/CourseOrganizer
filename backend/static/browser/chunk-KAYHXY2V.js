import{a as te}from"./chunk-E7AMMPSB.js";import"./chunk-FHQFZ7BW.js";import{a as N,b as A,c as B,d as J,e as H,f as G,g as R,h as q,i as z,j as U,k as Y,l as K,m as Q,n as X,q as Z}from"./chunk-DHWRSAE3.js";import{a as ee}from"./chunk-CJME7ZFP.js";import{a as $}from"./chunk-R3RPSZJZ.js";import{b as D}from"./chunk-E25IYVGI.js";import{Ba as L,Fa as O,G as d,Ga as W,I as w,Ia as F,J as T,Ja as P,N as _,U as m,V as t,W as i,X as g,Y as C,Z as M,_ as c,fa as j,ia as l,ja as y,ka as S,la as k,na as v,oa as x,pa as h,ra as I,u,v as p,va as E,w as f,x as b,xa as V}from"./chunk-X3WSSSVM.js";var ne=()=>[1,2,3];function re(o,n){if(o&1&&(t(0,"div",14)(1,"div",15)(2,"div",16),g(3,"div",17),t(4,"div",18),g(5,"div",19),i()(),g(6,"div",20)(7,"div",21),t(8,"div",22),g(9,"div",23)(10,"div",24),i(),t(11,"div",25),g(12,"div",26)(13,"div",27),i()()()),o&2){let e=n.$implicit;j("animation-delay",(e-1)*.1+"s")}}function oe(o,n){o&1&&(t(0,"div",3)(1,"div",4)(2,"div",5),f(),t(3,"svg",6),g(4,"path",7),i()(),b(),g(5,"div",8),i(),t(6,"div",9)(7,"h3",10),l(8,"Loading Meetings"),i(),t(9,"p",11),l(10,"Fetching your scheduled meetings..."),i(),t(11,"div",12),_(12,re,14,2,"div",13),i()()()),o&2&&(d(12),m("ngForOf",I(1,ne)))}function ae(o,n){if(o&1&&(t(0,"option",56),l(1),i()),o&2){let e=n.$implicit;m("value",e.id),d(),y(e.name)}}function de(o,n){o&1&&(t(0,"span"),l(1,"Creating..."),i())}function le(o,n){o&1&&(t(0,"span"),l(1,"Create Jitsi Meeting"),i())}function se(o,n){if(o&1){let e=C();t(0,"div",37)(1,"h3",38),l(2,"Create New Jitsi Meeting"),i(),t(3,"form",39),M("ngSubmit",function(){u(e);let r=c(2);return p(r.createJitsiMeeting())}),t(4,"div",40)(5,"div")(6,"label",41),l(7," Meeting Title "),i(),t(8,"input",42),h("ngModelChange",function(r){u(e);let s=c(2);return x(s.newMeeting.title,r)||(s.newMeeting.title=r),p(r)}),i()(),t(9,"div")(10,"label",43),l(11," Course "),i(),t(12,"select",44),h("ngModelChange",function(r){u(e);let s=c(2);return x(s.newMeeting.course,r)||(s.newMeeting.course=r),p(r)}),t(13,"option",32),l(14,"Select Course"),i(),_(15,ae,2,2,"option",33),i()()(),t(16,"div")(17,"label",45),l(18," Description (Optional) "),i(),t(19,"textarea",46),h("ngModelChange",function(r){u(e);let s=c(2);return x(s.newMeeting.description,r)||(s.newMeeting.description=r),p(r)}),i()(),t(20,"div",40)(21,"div")(22,"label",47),l(23," Scheduled Time "),i(),t(24,"input",48),h("ngModelChange",function(r){u(e);let s=c(2);return x(s.newMeeting.scheduled_time,r)||(s.newMeeting.scheduled_time=r),p(r)}),i()(),t(25,"div")(26,"label",49),l(27," Duration (minutes) "),i(),t(28,"input",50),h("ngModelChange",function(r){u(e);let s=c(2);return x(s.newMeeting.duration_minutes,r)||(s.newMeeting.duration_minutes=r),p(r)}),i()()(),t(29,"div",51)(30,"input",52),h("ngModelChange",function(r){u(e);let s=c(2);return x(s.newMeeting.is_recording_enabled,r)||(s.newMeeting.is_recording_enabled=r),p(r)}),i(),t(31,"label",53),l(32," Enable recording for this meeting "),i()(),t(33,"div",54)(34,"button",55),_(35,de,2,0,"span",2)(36,le,2,0,"span",2),i()()()()}if(o&2){let e=c(2);d(8),v("ngModel",e.newMeeting.title),d(4),v("ngModel",e.newMeeting.course),d(3),m("ngForOf",e.availableCourses),d(4),v("ngModel",e.newMeeting.description),d(5),v("ngModel",e.newMeeting.scheduled_time),d(4),v("ngModel",e.newMeeting.duration_minutes),d(2),v("ngModel",e.newMeeting.is_recording_enabled),d(4),m("disabled",e.isCreatingMeeting),d(),m("ngIf",e.isCreatingMeeting),d(),m("ngIf",!e.isCreatingMeeting)}}function me(o,n){if(o&1&&(t(0,"option",56),l(1),i()),o&2){let e=n.$implicit;m("value",e),d(),y(e)}}function ce(o,n){o&1&&(t(0,"span",75),l(1," \u{1F4F9} Recording "),i())}function ge(o,n){if(o&1){let e=C();t(0,"button",76),M("click",function(){u(e);let r=c().$implicit,s=c(2);return p(s.manageMeeting(r))}),f(),t(1,"svg",73),g(2,"path",77)(3,"path",78),i(),l(4," Manage "),i()}}function ue(o,n){if(o&1){let e=C();t(0,"div",57)(1,"div",15)(2,"div",16)(3,"div",58)(4,"div",59),f(),t(5,"svg",60),g(6,"path",61),i()()(),b(),t(7,"div",62)(8,"div",63)(9,"span",64),l(10),i(),_(11,ce,2,0,"span",65),i()()(),t(12,"h3",10),l(13),i(),t(14,"p",66),l(15),i(),t(16,"div",22)(17,"div",67),f(),t(18,"svg",68),g(19,"path",7),i(),l(20),E(21,"date"),E(22,"date"),i(),b(),t(23,"div",67),f(),t(24,"svg",68),g(25,"path",69),i(),l(26),i()(),b(),t(27,"div",25)(28,"div",11)(29,"span",70),l(30),i()(),t(31,"div",71)(32,"button",72),M("click",function(){let r=u(e).$implicit,s=c(2);return p(s.joinMeeting(r))}),f(),t(33,"svg",73),g(34,"path",61),i(),l(35),i(),_(36,ge,5,0,"button",74),i()()()()}if(o&2){let e,a=n.$implicit,r=c(2);d(10),S(" ",a.platform_display||"Jitsi Meet"," "),d(),m("ngIf",a.is_recording_enabled),d(2),y(a.title),d(2),y(a.description),d(5),k(" ",V(21,11,a.scheduled_time,"MMM d, y")," at ",V(22,14,a.scheduled_time,"h:mm a")," "),d(6),S(" ",a.created_by_name," "),d(4),y(a.created_by_name),d(2),m("disabled",!a.can_join),d(3),S(" ",a.can_join?"Join Meeting":"Not Available"," "),d(),m("ngIf",r.authService.isAdmin()||a.created_by===((e=r.authService.getCurrentUser())==null?null:e.id))}}function pe(o,n){o&1&&(t(0,"div",79),f(),t(1,"svg",80),g(2,"path",7),i(),b(),t(3,"h3",81),l(4,"No meetings scheduled"),i(),t(5,"p",82),l(6,"Online meetings will appear here once they are scheduled."),i()())}function _e(o,n){if(o&1){let e=C();t(0,"div"),_(1,se,37,10,"div",28),t(2,"div",29)(3,"label",30),l(4," Filter by Subject "),i(),t(5,"select",31),h("ngModelChange",function(r){u(e);let s=c();return x(s.selectedSubject,r)||(s.selectedSubject=r),p(r)}),M("change",function(){u(e);let r=c();return p(r.filterMeetings())}),t(6,"option",32),l(7,"All Subjects"),i(),_(8,me,2,2,"option",33),i()(),t(9,"div",34),_(10,ue,37,17,"div",35),i(),_(11,pe,7,0,"div",36),i()}if(o&2){let e=c();d(),m("ngIf",e.authService.isAdmin()),d(4),v("ngModel",e.selectedSubject),d(3),m("ngForOf",e.subjects),d(2),m("ngForOf",e.filteredMeetings),d(),m("ngIf",e.filteredMeetings.length===0&&!e.isLoading)}}var ie=class o{constructor(n,e,a,r){this.courseService=n;this.authService=e;this.videoCallService=a;this.cdr=r}meetings=[];filteredMeetings=[];subjects=[];selectedSubject="";isLoading=!0;isSidebarOpen=!1;isCreatingMeeting=!1;availableCourses=[];newMeeting={title:"",description:"",course:"",scheduled_time:"",duration_minutes:60,is_recording_enabled:!0};ngOnInit(){this.authService.isAuthenticated()?(this.loadMeetings(),this.authService.isAdmin()&&this.loadCourses()):this.isLoading=!1}onSidebarToggle(n){this.isSidebarOpen=n}loadMeetings(){this.isLoading=!0,this.courseService.getMeetings().subscribe({next:n=>{this.meetings=n,this.filteredMeetings=n,this.subjects=["All Courses"],this.isLoading=!1,this.cdr.detectChanges()},error:()=>{this.isLoading=!1,this.cdr.detectChanges()}})}filterMeetings(){this.selectedSubject&&this.selectedSubject!=="All Courses"?this.filteredMeetings=this.meetings.filter(n=>n.title.toLowerCase().includes(this.selectedSubject.toLowerCase())):this.filteredMeetings=this.meetings}loadCourses(){this.courseService.getCourses().subscribe({next:n=>{this.availableCourses=n.results||n||[]},error:n=>{console.error("Error loading courses:",n)}})}createJitsiMeeting(){if(!this.newMeeting.title||!this.newMeeting.course||!this.newMeeting.scheduled_time){alert("Please fill in all required fields");return}this.isCreatingMeeting=!0;let n={title:this.newMeeting.title,description:this.newMeeting.description,course:parseInt(this.newMeeting.course),scheduled_time:this.newMeeting.scheduled_time,duration:this.newMeeting.duration_minutes?`${this.newMeeting.duration_minutes}:00`:null,is_recording_enabled:this.newMeeting.is_recording_enabled,platform:"jitsi"};this.courseService.createJitsiMeeting(n).subscribe({next:e=>{console.log("Meeting created successfully:",e),this.loadMeetings(),this.resetForm(),alert("Jitsi meeting created successfully!")},error:e=>{console.error("Error creating meeting:",e),alert("Error creating meeting. Please try again.")},complete:()=>{this.isCreatingMeeting=!1}})}resetForm(){this.newMeeting={title:"",description:"",course:"",scheduled_time:"",duration_minutes:60,is_recording_enabled:!0}}joinMeeting(n){if(!n.can_join){alert("This meeting is not available for joining at this time.");return}let e=this.videoCallService.getMediaDeviceInfo();if(console.log("Media device info:",e),!this.videoCallService.isSecureContext()){alert("Camera and microphone access requires a secure connection (HTTPS). Please ensure you are using HTTPS.");return}if(!this.videoCallService.isMediaDevicesSupported()){alert("Your browser does not support camera and microphone access. Please use a modern browser.");return}this.videoCallService.joinMeeting(n.id).subscribe({next:a=>{this.videoCallService.openEmbeddedVideoCall(a)},error:a=>{console.error("Error joining meeting:",a),alert("Error joining meeting. Please try again.")}})}manageMeeting(n){let e=`
Meeting: ${n.title}
Status: ${n.status_display||"Scheduled"}
Platform: ${n.platform_display||"Jitsi Meet"}
Recording: ${n.is_recording_enabled?"Enabled":"Disabled"}
Meeting ID: ${n.meeting_id}
    `.trim();alert(e)}static \u0275fac=function(e){return new(e||o)(w(ee),w(D),w(te),w(L))};static \u0275cmp=T({type:o,selectors:[["app-meetings"]],decls:3,vars:3,consts:[["pageTitle","Online Meetings","pageSubtitle","University of Nairobi - Join virtual classes and meetings",3,"sidebarToggle","isSidebarOpen"],["class","flex flex-col items-center justify-center py-20",4,"ngIf"],[4,"ngIf"],[1,"flex","flex-col","items-center","justify-center","py-20"],[1,"relative"],[1,"w-16","h-16","bg-blue-100","rounded-lg","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-8","h-8","text-blue-600","animate-pulse"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"absolute","-inset-2","w-20","h-20","border-2","border-blue-200","border-t-blue-600","rounded-full","animate-spin"],[1,"mt-6","text-center"],[1,"text-lg","font-medium","text-gray-900","mb-2"],[1,"text-sm","text-gray-500"],[1,"mt-8","grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6","w-full"],["class","bg-white rounded-lg shadow-md animate-pulse",3,"animation-delay",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","shadow-md","animate-pulse"],[1,"p-6"],[1,"flex","items-center","mb-4"],[1,"h-10","w-10","bg-gray-200","rounded-lg"],[1,"ml-3"],[1,"h-6","w-16","bg-gray-200","rounded-full"],[1,"h-6","bg-gray-200","rounded","mb-2"],[1,"h-4","bg-gray-200","rounded","mb-3","w-3/4"],[1,"space-y-2","mb-4"],[1,"h-3","bg-gray-200","rounded","w-full"],[1,"h-3","bg-gray-200","rounded","w-2/3"],[1,"flex","items-center","justify-between"],[1,"h-4","bg-gray-200","rounded","w-1/2"],[1,"h-8","w-16","bg-gray-200","rounded"],["class","mb-8 bg-white rounded-lg shadow-md p-6",4,"ngIf"],[1,"mb-6"],["for","subject-filter",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","subject-filter",1,"block","w-full","max-w-xs","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-primary-500","focus:border-primary-500","sm:text-sm",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200",4,"ngFor","ngForOf"],["class","text-center py-12",4,"ngIf"],[1,"mb-8","bg-white","rounded-lg","shadow-md","p-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"space-y-4",3,"ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","meeting-title",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","meeting-title","name","title","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-primary-500","focus:border-primary-500",3,"ngModelChange","ngModel"],["for","meeting-course",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","meeting-course","name","course","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-primary-500","focus:border-primary-500",3,"ngModelChange","ngModel"],["for","meeting-description",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","meeting-description","name","description","rows","3",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-primary-500","focus:border-primary-500",3,"ngModelChange","ngModel"],["for","meeting-time",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","datetime-local","id","meeting-time","name","scheduled_time","required","",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-primary-500","focus:border-primary-500",3,"ngModelChange","ngModel"],["for","meeting-duration",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","number","id","meeting-duration","name","duration_minutes","min","15","max","480","placeholder","60",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","focus:ring-primary-500","focus:border-primary-500",3,"ngModelChange","ngModel"],[1,"flex","items-center"],["type","checkbox","id","recording-enabled","name","is_recording_enabled",1,"h-4","w-4","text-primary-600","focus:ring-primary-500","border-gray-300","rounded",3,"ngModelChange","ngModel"],["for","recording-enabled",1,"ml-2","block","text-sm","text-gray-700"],[1,"flex","justify-end"],["type","submit",1,"bg-primary-600","hover:bg-primary-700","disabled:bg-gray-400","text-white","px-6","py-2","rounded-md","font-medium","transition-colors",3,"disabled"],[3,"value"],[1,"bg-white","rounded-lg","shadow-md","hover:shadow-lg","transition-shadow","duration-200"],[1,"flex-shrink-0"],[1,"h-10","w-10","bg-green-100","rounded-lg","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"ml-3","flex-1"],[1,"flex","items-center","space-x-2"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],["class","inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",4,"ngIf"],[1,"text-sm","text-gray-600","mb-3"],[1,"flex","items-center","text-sm","text-gray-500"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"],[1,"font-medium"],[1,"flex","space-x-2"],[1,"inline-flex","items-center","px-3","py-2","border","border-transparent","text-sm","leading-4","font-medium","rounded-md","text-white","bg-green-600","hover:bg-green-700","disabled:bg-gray-400","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-500",3,"click","disabled"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4","mr-1"],["class","inline-flex items-center px-3 py-2 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",3,"click",4,"ngIf"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-red-100","text-red-800"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-500",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"text-center","py-12"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"mx-auto","h-12","w-12","text-gray-400"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"]],template:function(e,a){e&1&&(t(0,"app-page-layout",0),M("sidebarToggle",function(s){return a.onSidebarToggle(s)}),_(1,oe,13,2,"div",1)(2,_e,12,5,"div",2),i()),e&2&&(m("isSidebarOpen",a.isSidebarOpen),d(),m("ngIf",a.isLoading),d(),m("ngIf",!a.isLoading))},dependencies:[P,O,W,Z,R,U,Y,A,q,N,z,B,J,X,Q,K,G,H,$,F],encapsulation:2})};export{ie as MeetingsComponent};
