import{a as k,b as N,c as I,d as W,e as F,f as A,g as j,n as q,o as B,p as G,q as Y}from"./chunk-DHWRSAE3.js";import{b as T}from"./chunk-E25IYVGI.js";import{Ba as E,G as s,Ga as R,I as w,J as M,Ja as P,N as x,Ra as V,Sa as L,U as l,V as t,W as r,Wa as X,X as y,Y as C,Z as _,_ as g,ga as D,ia as n,ka as S,na as p,oa as f,pa as b,u as c,v as u,w as h,x as v}from"./chunk-X3WSSSVM.js";function O(o,d){if(o&1){let e=C();t(0,"div",3)(1,"div",15),h(),t(2,"svg",16),y(3,"path",17),r()(),v(),t(4,"h3",18),n(5,"Registration Complete"),r(),t(6,"p",19),n(7," You have already registered for the Course Organizer. Your account is pending administrative approval. "),r(),t(8,"div",20)(9,"a",21),n(10," Go to Login "),r(),t(11,"button",22),_("click",function(){c(e);let i=g();return u(i.showRegistrationForm=!0)}),n(12," Register Another Account "),r()()()}}function H(o,d){if(o&1&&(t(0,"div",58),n(1),r()),o&2){let e=g(2);s(),S(" ",e.registrationError," ")}}function U(o,d){o&1&&(t(0,"div",59)(1,"div",60),y(2,"div",61)(3,"div",62)(4,"div",63),r()())}function Z(o,d){o&1&&(t(0,"div",58),n(1," You must agree to the Privacy Policy to continue. "),r())}function J(o,d){o&1&&(t(0,"div",71)(1,"p",72),n(2,"You might already be registered. Try logging in instead:"),r(),t(3,"a",73),n(4," Go to Login "),r()())}function K(o,d){if(o&1&&(t(0,"div",64)(1,"div",65)(2,"div",47),h(),t(3,"svg",66),y(4,"path",67),r()(),v(),t(5,"div",68)(6,"div",69),n(7),r(),x(8,J,5,0,"div",70),r()()()),o&2){let e=g(2);s(7),S(" ",e.errorMessage," "),s(),l("ngIf",e.isDuplicateRegistrationError())}}function Q(o,d){o&1&&(t(0,"span"),n(1,"Register"),r())}function $(o,d){o&1&&(t(0,"span",74),h(),t(1,"svg",75),y(2,"circle",76)(3,"path",77),r(),n(4," Registering... "),r())}function ee(o,d){if(o&1){let e=C();t(0,"form",23,0),_("ngSubmit",function(){c(e);let i=g();return u(i.onSubmit())}),t(2,"div")(3,"label",24),n(4," First Name "),r(),t(5,"input",25),b("ngModelChange",function(i){c(e);let a=g();return f(a.registrationData.first_name,i)||(a.registrationData.first_name=i),u(i)}),r()(),t(6,"div")(7,"label",26),n(8," Last Name "),r(),t(9,"input",27),b("ngModelChange",function(i){c(e);let a=g();return f(a.registrationData.last_name,i)||(a.registrationData.last_name=i),u(i)}),r()(),t(10,"div")(11,"label",28),n(12," School Email Address "),r(),t(13,"input",29),b("ngModelChange",function(i){c(e);let a=g();return f(a.registrationData.email,i)||(a.registrationData.email=i),u(i)}),_("blur",function(){c(e);let i=g();return u(i.registrationData.email=i.registrationData.email.trim())}),r(),t(14,"p",30),n(15,"Use your official school email: "),t(16,"span",31),n(17,"@students.uonbi.ac.ke"),r()()(),t(18,"div")(19,"label",32),n(20," Registration Number "),r(),t(21,"input",33),b("ngModelChange",function(i){c(e);let a=g();return f(a.registrationData.registration_number,i)||(a.registrationData.registration_number=i),u(i)}),_("blur",function(){c(e);let i=g();return u(i.validateRegistrationNumber())}),r(),x(22,H,2,1,"div",34),t(23,"div",30),n(24," Format: GPR3/XXXXXX/2025 (where XXXXXX is your unique number) "),r()(),t(25,"div")(26,"label",35),n(27," Phone Number "),r(),t(28,"input",36),b("ngModelChange",function(i){c(e);let a=g();return f(a.registrationData.phone_number,i)||(a.registrationData.phone_number=i),u(i)}),r()(),t(29,"div")(30,"label",37),n(31," Password "),r(),t(32,"input",38),b("ngModelChange",function(i){c(e);let a=g();return f(a.registrationData.password,i)||(a.registrationData.password=i),u(i)}),r()(),t(33,"div")(34,"label",39),n(35," Confirm Password "),r(),t(36,"input",40),b("ngModelChange",function(i){c(e);let a=g();return f(a.registrationData.confirm_password,i)||(a.registrationData.confirm_password=i),u(i)}),r(),x(37,U,5,0,"div",41),r(),t(38,"div",42)(39,"div",3)(40,"h3",43),n(41," Verification Process "),r(),t(42,"p",44),n(43," Your registration will be verified by administrators. You'll receive a passcode via SMS once approved. "),r()()(),t(44,"div",45)(45,"div",46)(46,"div",47)(47,"input",48),b("ngModelChange",function(i){c(e);let a=g();return f(a.registrationData.agreeToPrivacyPolicy,i)||(a.registrationData.agreeToPrivacyPolicy=i),u(i)}),r()(),t(48,"div",49)(49,"label",50),n(50," I agree to the "),t(51,"a",51),n(52," Privacy Policy "),r(),n(53," and consent to the collection, processing, and use of my personal information as described therein. "),r(),x(54,Z,2,0,"div",34),r()()(),x(55,K,9,2,"div",52),t(56,"div")(57,"button",53),x(58,Q,2,0,"span",54)(59,$,5,0,"span",55),r()(),t(60,"div",3)(61,"p",56),n(62," Already have an account? "),t(63,"a",57),n(64," Sign in here "),r()()()()}if(o&2){let e=g();s(5),l("disabled",e.isLoading),p("ngModel",e.registrationData.first_name),s(4),l("disabled",e.isLoading),p("ngModel",e.registrationData.last_name),s(4),l("disabled",e.isLoading),p("ngModel",e.registrationData.email),l("pattern",".+@students.uonbi.ac.ke"),s(8),D("border-red-300",e.registrationError)("focus:ring-red-500",e.registrationError)("focus:border-red-500",e.registrationError),l("disabled",e.isLoading),p("ngModel",e.registrationData.registration_number),s(),l("ngIf",e.registrationError),s(6),l("disabled",e.isLoading),p("ngModel",e.registrationData.phone_number),s(4),l("disabled",e.isLoading),p("ngModel",e.registrationData.password),s(4),l("disabled",e.isLoading),p("ngModel",e.registrationData.confirm_password),s(),l("ngIf",e.isLoading),s(10),l("disabled",e.isLoading),p("ngModel",e.registrationData.agreeToPrivacyPolicy),s(7),l("ngIf",!e.registrationData.agreeToPrivacyPolicy&&e.registrationData.agreeToPrivacyPolicy!==void 0),s(),l("ngIf",e.errorMessage),s(2),l("disabled",e.isLoading||!e.isFormValid()),s(),l("ngIf",!e.isLoading),s(),l("ngIf",e.isLoading)}}var z=class o{constructor(d,e,m){this.authService=d;this.router=e;this.cdr=m}registrationData={first_name:"",last_name:"",email:"",registration_number:"",phone_number:"",password:"",confirm_password:"",agreeToPrivacyPolicy:!1};isLoading=!1;errorMessage="";successMessage="";registrationError="";registrationDetails=null;showRegistrationForm=!0;ngOnInit(){this.authService.isAuthenticated()&&this.router.navigate(["/dashboard"])}validateRegistrationNumber(){let d=this.registrationData.registration_number.trim(),e=/^[A-Z]{1,4}\d{0,2}\/\d{1,6}\/\d{4}$/,m=/^GPR3\/\d{1,6}\/2025$/;if(!d){this.registrationError="";return}if(!e.test(d)){this.registrationError="Registration number must be in format: PREFIX/XXXXXX/YYYY";return}if(m.test(d)){this.registrationError="";return}this.registrationError="Note: This appears to be for a different class. Class of 2029 uses format GPR3/XXXXXX/2025"}isFormValid(){let d=this.registrationData.registration_number.trim(),e=/^[A-Z]{1,4}\d{0,2}\/\d{1,6}\/\d{4}$/,m=/.+@students\.uonbi\.ac\.ke$/i.test(this.registrationData.email.trim());return this.registrationData.first_name.trim()!==""&&this.registrationData.last_name.trim()!==""&&m&&this.registrationData.registration_number.trim()!==""&&this.registrationData.phone_number.trim()!==""&&this.registrationData.password.trim()!==""&&this.registrationData.confirm_password.trim()!==""&&this.registrationData.password===this.registrationData.confirm_password&&this.registrationData.agreeToPrivacyPolicy===!0&&e.test(d)}onSubmit(){if(!this.isFormValid()){this.cdr.detectChanges();return}this.isLoading=!0,this.errorMessage="",this.successMessage="",this.cdr.detectChanges();let d={first_name:this.registrationData.first_name,last_name:this.registrationData.last_name,email:this.registrationData.email,registration_number:this.registrationData.registration_number,phone_number:this.registrationData.phone_number,password:this.registrationData.password,confirm_password:this.registrationData.confirm_password};this.authService.register(d).subscribe({next:e=>{this.isLoading=!1,this.registrationDetails=e,this.successMessage=e.message||"Registration submitted successfully! You will receive an email notification once your account is approved by administrators.",this.registrationData={first_name:"",last_name:"",email:"",registration_number:"",phone_number:"",password:"",confirm_password:"",agreeToPrivacyPolicy:!1},this.showRegistrationForm=!1,this.cdr.detectChanges()},error:e=>{this.isLoading=!1,console.error("Registration error:",e),e.error?.registration_number?this.errorMessage=e.error.registration_number[0]:e.error?.message?this.errorMessage=e.error.message:e.error?.non_field_errors?this.errorMessage=e.error.non_field_errors[0]:this.errorMessage="An error occurred during registration. Please try again.",this.cdr.detectChanges()}})}resetForm(){this.registrationData={first_name:"",last_name:"",email:"",registration_number:"",phone_number:"",password:"",confirm_password:"",agreeToPrivacyPolicy:!1},this.errorMessage="",this.successMessage="",this.registrationDetails=null,this.registrationError="",this.showRegistrationForm=!0,this.cdr.detectChanges()}isDuplicateRegistrationError(){return!!(this.errorMessage&&(this.errorMessage.includes("already registered")||this.errorMessage.includes("pending approval")||this.errorMessage.includes("already registered and approved")))}static \u0275fac=function(e){return new(e||o)(w(T),w(V),w(E))};static \u0275cmp=M({type:o,selectors:[["app-register"]],decls:18,vars:2,consts:[["registerForm","ngForm"],[1,"min-h-screen","bg-white","flex","flex-col","justify-center","py-12","px-6"],[1,"sm:mx-auto","sm:w-full","sm:max-w-md"],[1,"text-center"],[1,"flex","justify-center","mb-6"],["src","/courseorganizerlogo.png","alt","Course Organizer Logo",1,"h-12","w-auto"],[1,"text-3xl","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"],[1,"bg-gray-50","border","border-gray-200","rounded-xl","p-4"],[1,"text-sm","text-gray-700"],[1,"font-semibold"],[1,"mt-8","sm:mx-auto","sm:w-full","sm:max-w-md"],[1,"bg-white","border","border-gray-200","rounded-2xl","p-8"],["class","text-center",4,"ngIf"],["class","space-y-6",3,"ngSubmit",4,"ngIf"],[1,"mx-auto","flex","items-center","justify-center","h-16","w-16","rounded-2xl","bg-green-50","border","border-green-200","mb-6"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-8","w-8","text-green-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"text-xl","font-semibold","text-gray-900","mb-3"],[1,"text-gray-600","mb-8"],[1,"space-y-3"],["routerLink","/login",1,"w-full","bg-gray-900","hover:bg-gray-800","text-white","py-3","px-4","rounded-xl","font-semibold","transition-colors","text-center","block"],["type","button",1,"w-full","border-2","border-gray-300","hover:border-gray-400","text-gray-700","hover:text-gray-900","py-3","px-4","rounded-xl","font-medium","transition-colors",3,"click"],[1,"space-y-6",3,"ngSubmit"],["for","firstName",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","firstName","name","firstName","type","text","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-xl","text-gray-900","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-gray-900","focus:border-transparent","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","disabled","ngModel"],["for","lastName",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","lastName","name","lastName","type","text","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-xl","text-gray-900","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-gray-900","focus:border-transparent","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","disabled","ngModel"],["for","email",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","email","name","email","type","email","required","","placeholder","your.name@students.uonbi.ac.ke","title","Use your official school email ending with @students.uonbi.ac.ke",1,"w-full","px-4","py-3","border","border-gray-300","rounded-xl","text-gray-900","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-gray-900","focus:border-transparent","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","blur","disabled","ngModel","pattern"],[1,"mt-2","text-xs","text-gray-500"],[1,"font-medium"],["for","registrationNumber",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","registrationNumber","name","registrationNumber","type","text","required","","placeholder","GPR3/123456/2025",1,"w-full","px-4","py-3","border","border-gray-300","rounded-xl","text-gray-900","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-gray-900","focus:border-transparent","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","blur","disabled","ngModel"],["class","mt-2 text-sm text-red-600",4,"ngIf"],["for","phoneNumber",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","phoneNumber","name","phoneNumber","type","tel","required","","placeholder","+254 XXX XXX XXX",1,"w-full","px-4","py-3","border","border-gray-300","rounded-xl","text-gray-900","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-gray-900","focus:border-transparent","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","disabled","ngModel"],["for","password",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","password","name","password","type","password","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-xl","text-gray-900","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-gray-900","focus:border-transparent","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","disabled","ngModel"],["for","confirmPassword",1,"block","text-sm","font-medium","text-gray-700","mb-2"],["id","confirmPassword","name","confirmPassword","type","password","required","",1,"w-full","px-4","py-3","border","border-gray-300","rounded-xl","text-gray-900","placeholder-gray-500","focus:outline-none","focus:ring-2","focus:ring-gray-900","focus:border-transparent","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","disabled","ngModel"],["class","flex items-center justify-center mt-3",4,"ngIf"],[1,"bg-blue-50","border","border-blue-200","rounded-xl","p-6"],[1,"text-sm","font-semibold","text-blue-900","mb-2"],[1,"text-sm","text-blue-700"],[1,"bg-gray-50","border","border-gray-200","rounded-xl","p-6"],[1,"flex","items-start","space-x-3"],[1,"flex-shrink-0"],["id","privacyPolicy","name","privacyPolicy","type","checkbox","required","",1,"h-4","w-4","text-gray-900","focus:ring-gray-900","border-gray-300","rounded","disabled:opacity-50","disabled:cursor-not-allowed",3,"ngModelChange","disabled","ngModel"],[1,"flex-1"],["for","privacyPolicy",1,"text-sm","text-gray-700"],["routerLink","/privacy-policy","target","_blank",1,"text-gray-900","hover:text-gray-700","underline","font-medium"],["class","bg-red-50 border border-red-200 rounded-xl p-4",4,"ngIf"],["type","submit",1,"w-full","bg-gray-900","hover:bg-gray-800","text-white","py-3","px-4","rounded-xl","font-semibold","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[4,"ngIf"],["class","flex items-center justify-center",4,"ngIf"],[1,"text-sm","text-gray-600"],["routerLink","/login",1,"font-medium","text-gray-900","hover:text-gray-700"],[1,"mt-2","text-sm","text-red-600"],[1,"flex","items-center","justify-center","mt-3"],[1,"flex","items-center","space-x-2","text-gray-500"],[1,"w-2","h-2","bg-gray-400","rounded-full","animate-bounce"],[1,"w-2","h-2","bg-gray-400","rounded-full","animate-bounce",2,"animation-delay","0.1s"],[1,"w-2","h-2","bg-gray-400","rounded-full","animate-bounce",2,"animation-delay","0.2s"],[1,"bg-red-50","border","border-red-200","rounded-xl","p-4"],[1,"flex"],["fill","currentColor","viewBox","0 0 20 20",1,"h-5","w-5","text-red-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[1,"ml-3"],[1,"text-sm","text-red-700"],["class","mt-3",4,"ngIf"],[1,"mt-3"],[1,"text-sm","text-red-600","mb-2"],["routerLink","/login",1,"inline-flex","items-center","px-3","py-2","border","border-transparent","text-sm","leading-4","font-medium","rounded-xl","text-red-700","bg-red-100","hover:bg-red-200","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-red-500"],[1,"flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(e,m){e&1&&(t(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),y(4,"img",5),r(),t(5,"h2",6),n(6," Join Course Organizer "),r(),t(7,"p",7),n(8," University of Nairobi - Class of 2029 Students "),r(),t(9,"div",8)(10,"p",9)(11,"span",10),n(12,"Eligible:"),r(),n(13," First-year law students with GPR3/XXXXXX/2025 registration number "),r()()()(),t(14,"div",11)(15,"div",12),x(16,O,13,0,"div",13)(17,ee,65,30,"form",14),r()()()),e&2&&(s(16),l("ngIf",!m.showRegistrationForm),s(),l("ngIf",m.showRegistrationForm))},dependencies:[P,R,Y,j,N,k,I,W,q,G,B,A,F,X,L],encapsulation:2})};export{z as RegisterComponent};
