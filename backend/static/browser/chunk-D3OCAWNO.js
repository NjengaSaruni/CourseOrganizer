import{a as k}from"./chunk-CJME7ZFP.js";import{a as j}from"./chunk-R3RPSZJZ.js";import{b as T}from"./chunk-E25IYVGI.js";import{Ba as E,E as y,Fa as C,G as a,Ga as I,I as x,J as S,Ja as w,N as m,Sa as M,U as d,V as e,W as t,Wa as D,X as c,Z as _,_ as h,g as p,ia as n,ja as s,k as b,ka as f,l as g,w as v,x as u}from"./chunk-X3WSSSVM.js";function F(o,i){o&1&&(e(0,"div",3),c(1,"div",4),e(2,"div",5)(3,"h3",6),n(4,"Loading Dashboard"),t(),e(5,"p",7),n(6,"Fetching your course data..."),t()()())}function V(o,i){if(o&1&&(e(0,"div",35)(1,"div",10)(2,"div",11)(3,"div",36),v(),e(4,"svg",37),c(5,"path",14),t()()(),u(),e(6,"div",15)(7,"p",38),n(8),t(),e(9,"p",39),n(10),t()()(),e(11,"a",40),n(12," View "),t()()),o&2){let r=i.$implicit;a(8),s(r.title),a(2),s(r.description),a(),d("href",r.file_url,y)}}function Y(o,i){if(o&1&&(e(0,"div",41)(1,"div",10)(2,"div",11)(3,"div",42)(4,"span",38),n(5),t()()(),e(6,"div",15)(7,"p",38),n(8),t(),e(9,"p",39),n(10),t()()(),e(11,"div",43)(12,"p",44),n(13),t(),e(14,"p",39),n(15),t()()()),o&2){let r=i.$implicit;a(5),s(r.day.charAt(0)),a(3),s(r.subject),a(2),s(r.time),a(3),s(r.location),a(2),s(r.lecturer)}}function B(o,i){o&1&&(e(0,"span",57),n(1," Core "),t())}function R(o,i){if(o&1&&(e(0,"div",50)(1,"div",51)(2,"div",52)(3,"h4",38),n(4),t(),e(5,"p",53),n(6),t(),e(7,"div",54)(8,"span",55),n(9),t(),m(10,B,2,0,"span",56),t()()()()),o&2){let r=i.$implicit;a(4),s(r.code),a(2),s(r.name),a(3),f(" ",r.credits," credits "),a(),d("ngIf",r.is_core)}}function A(o,i){if(o&1&&(e(0,"div",28)(1,"div",22)(2,"div",45)(3,"h3",46),n(4),t(),e(5,"span",47),n(6),t()(),e(7,"div",48),m(8,R,11,4,"div",49),t()()()),o&2){let r=i.$implicit,l=h(2);a(4),f(" Year ",r," - First Semester "),a(2),f(" ",l.coursesByYear[r].length," courses "),a(2),d("ngForOf",l.coursesByYear[r])}}function H(o,i){if(o&1&&(e(0,"div")(1,"div",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"div",12),v(),e(6,"svg",13),c(7,"path",14),t()()(),u(),e(8,"div",15)(9,"p",16),n(10,"Materials"),t(),e(11,"p",17),n(12),t()()()(),e(13,"div",9)(14,"div",10)(15,"div",11)(16,"div",12),v(),e(17,"svg",13),c(18,"path",18),t()()(),u(),e(19,"div",15)(20,"p",16),n(21,"Recordings"),t(),e(22,"p",17),n(23),t()()()(),e(24,"div",9)(25,"div",10)(26,"div",11)(27,"div",12),v(),e(28,"svg",13),c(29,"path",19),t()()(),u(),e(30,"div",15)(31,"p",16),n(32,"Meetings"),t(),e(33,"p",17),n(34),t()()()(),e(35,"div",9)(36,"div",10)(37,"div",11)(38,"div",12),v(),e(39,"svg",13),c(40,"path",20),t()()(),u(),e(41,"div",15)(42,"p",16),n(43,"Classes"),t(),e(44,"p",17),n(45),t()()()()(),e(46,"div",21)(47,"div",22)(48,"h3",23),n(49,"Recent Materials"),t(),e(50,"div",24),m(51,V,13,3,"div",25),t(),e(52,"div",26)(53,"a",27),n(54," View all materials \u2192 "),t()()()(),e(55,"div",28)(56,"div",22)(57,"h3",23),n(58,"Upcoming Classes"),t(),e(59,"div",24),m(60,Y,16,5,"div",29),t(),e(61,"div",26)(62,"a",30),n(63," View full timetable \u2192 "),t()()()(),e(64,"div",31)(65,"h2",32),n(66,"Courses by Academic Year"),t(),e(67,"div",33),m(68,A,9,3,"div",34),t()()()),o&2){let r=h();a(12),s(r.materials.length),a(11),s(r.recordings.length),a(11),s(r.meetings.length),a(11),s(r.timetable.length),a(6),d("ngForOf",r.materials.slice(0,3)),a(9),d("ngForOf",r.timetable.slice(0,3)),a(8),d("ngForOf",r.getYears())}}var L=class o{constructor(i,r,l){this.courseService=i;this.authService=r;this.cdr=l}materials=[];meetings=[];recordings=[];timetable=[];courses=[];coursesByYear={};isLoading=!0;isSidebarOpen=!1;currentUser=null;ngOnInit(){this.authService.currentUser$.subscribe(i=>{this.currentUser=i}),this.authService.isAuthenticated()?this.loadDashboardData():this.isLoading=!1}onSidebarToggle(i){this.isSidebarOpen=i}getYears(){return Object.keys(this.coursesByYear).map(i=>parseInt(i)).sort()}loadDashboardData(){this.isLoading=!0,b({materials:this.courseService.getMaterials().pipe(g(i=>(console.error("Error loading materials:",i),p([])))),meetings:this.courseService.getMeetings().pipe(g(i=>(console.error("Error loading meetings:",i),p([])))),recordings:this.courseService.getRecordings().pipe(g(i=>(console.error("Error loading recordings:",i),p([])))),timetable:this.courseService.getTimetable().pipe(g(i=>(console.error("Error loading timetable:",i),p([])))),courses:this.courseService.getCourses().pipe(g(i=>(console.error("Error loading courses:",i),p([]))))}).subscribe({next:i=>{this.materials=i.materials,this.meetings=i.meetings,this.recordings=i.recordings,this.timetable=i.timetable,this.courses=i.courses,this.coursesByYear={},Array.isArray(this.courses)?this.courses.forEach(r=>{this.coursesByYear[r.year]||(this.coursesByYear[r.year]=[]),this.coursesByYear[r.year].push(r)}):console.warn("Courses data is not an array:",this.courses),this.isLoading=!1,this.cdr.detectChanges()},error:i=>{console.error("Error loading dashboard data:",i),this.isLoading=!1,this.cdr.detectChanges()}})}static \u0275fac=function(r){return new(r||o)(x(k),x(T),x(E))};static \u0275cmp=S({type:o,selectors:[["app-dashboard"]],decls:3,vars:3,consts:[["pageTitle","University of Nairobi - Dashboard","pageSubtitle","Welcome to your course management system",3,"sidebarToggle","isSidebarOpen"],["class","flex flex-col items-center justify-center py-20",4,"ngIf"],[4,"ngIf"],[1,"flex","flex-col","items-center","justify-center","py-20"],[1,"w-16","h-16","border-4","border-gray-200","border-t-gray-900","rounded-full","animate-spin"],[1,"mt-6","text-center"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6","mb-8"],[1,"bg-white","border","border-gray-200","rounded-2xl","p-6"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"w-12","h-12","bg-gray-100","rounded-2xl","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-6","w-6","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-500"],[1,"text-2xl","font-semibold","text-gray-900"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-white","border","border-gray-200","rounded-2xl","mb-8"],[1,"p-6"],[1,"text-xl","font-semibold","text-gray-900","mb-6"],[1,"space-y-4"],["class","flex items-center justify-between p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"mt-6"],["routerLink","/materials",1,"text-gray-900","hover:text-gray-700","text-sm","font-medium"],[1,"bg-white","border","border-gray-200","rounded-2xl"],["class","flex items-center justify-between p-4 border border-gray-200 rounded-xl",4,"ngFor","ngForOf"],["routerLink","/timetable",1,"text-gray-900","hover:text-gray-700","text-sm","font-medium"],[1,"mt-8"],[1,"text-2xl","font-semibold","text-gray-900","mb-8"],[1,"space-y-8"],["class","bg-white border border-gray-200 rounded-2xl",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","p-4","border","border-gray-200","rounded-xl","hover:bg-gray-50","transition-colors"],[1,"w-10","h-10","bg-gray-100","rounded-xl","flex","items-center","justify-center"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5","text-gray-600"],[1,"text-sm","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"text-gray-900","hover:text-gray-700","text-sm","font-medium",3,"href"],[1,"flex","items-center","justify-between","p-4","border","border-gray-200","rounded-xl"],[1,"h-12","w-12","bg-gray-100","rounded-2xl","flex","items-center","justify-center"],[1,"text-right"],[1,"text-sm","text-gray-900"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-xl","font-semibold","text-gray-900"],[1,"inline-flex","items-center","px-3","py-1","rounded-full","text-sm","font-medium","bg-gray-100","text-gray-700"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],["class","border border-gray-200 rounded-xl p-4 hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"border","border-gray-200","rounded-xl","p-4","hover:bg-gray-50","transition-colors"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"text-sm","text-gray-600","mt-1"],[1,"mt-3","flex","items-center","text-xs","text-gray-500"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","bg-gray-100","text-gray-700","mr-2"],["class","inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-700",4,"ngIf"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","bg-green-100","text-green-700"]],template:function(r,l){r&1&&(e(0,"app-page-layout",0),_("sidebarToggle",function(O){return l.onSidebarToggle(O)}),m(1,F,7,0,"div",1)(2,H,69,7,"div",2),t()),r&2&&(d("isSidebarOpen",l.isSidebarOpen),a(),d("ngIf",l.isLoading),a(),d("ngIf",!l.isLoading))},dependencies:[w,C,I,D,M,j],encapsulation:2})};export{L as DashboardComponent};
