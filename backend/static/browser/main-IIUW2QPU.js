import{a as te}from"./chunk-FHQFZ7BW.js";import{q as ee}from"./chunk-DHWRSAE3.js";import{b as A}from"./chunk-E25IYVGI.js";import{A as F,Ba as V,G as l,Ga as P,I as b,J as S,Ja as R,Ka as K,N as v,Na as $,O as k,Oa as Z,P as L,Qa as Y,Ra as H,U as u,Ua as Q,V as r,Va as X,W as a,X as c,Y as y,Z as h,_ as d,ba as T,ca as I,da as W,ga as U,ha as w,ia as C,ja as j,p as M,s as E,t as B,u as m,v as p,w as g,x as _,ya as q,z}from"./chunk-X3WSSSVM.js";var f=class n{constructor(t,e){this.authService=t;this.router=e}canActivate(){return this.authService.isAuthenticated()?!0:(this.router.navigate(["/login"]),!1)}static \u0275fac=function(e){return new(e||n)(E(A),E(H))};static \u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"})};var O=class n{constructor(t,e){this.authService=t;this.router=e}canActivate(){return this.authService.isAuthenticated()&&this.authService.isAdmin()?!0:(this.authService.isAuthenticated()?this.router.navigate(["/dashboard"]):this.router.navigate(["/login"]),!1)}static \u0275fac=function(e){return new(e||n)(E(A),E(H))};static \u0275prov=M({token:n,factory:n.\u0275fac,providedIn:"root"})};var ie=[{path:"",loadComponent:()=>import("./chunk-KFWBE5G2.js").then(n=>n.LandingComponent)},{path:"about",loadComponent:()=>import("./chunk-XOZEFZ2V.js").then(n=>n.AboutComponent)},{path:"login",loadComponent:()=>import("./chunk-AM622LXB.js").then(n=>n.LoginComponent)},{path:"register",loadComponent:()=>import("./chunk-KROPXGLU.js").then(n=>n.RegisterComponent)},{path:"privacy-policy",loadComponent:()=>import("./chunk-YT2PGAE7.js").then(n=>n.PrivacyPolicyComponent)},{path:"dashboard",loadComponent:()=>import("./chunk-D3OCAWNO.js").then(n=>n.DashboardComponent),canActivate:[f]},{path:"timetable",loadComponent:()=>import("./chunk-WJVB7ANK.js").then(n=>n.TimetableComponent),canActivate:[f]},{path:"materials",loadComponent:()=>import("./chunk-RHNSNCB5.js").then(n=>n.MaterialsComponent),canActivate:[f]},{path:"recordings",loadComponent:()=>import("./chunk-A2HJVLZV.js").then(n=>n.RecordingsComponent),canActivate:[f]},{path:"meetings",loadComponent:()=>import("./chunk-KAYHXY2V.js").then(n=>n.MeetingsComponent),canActivate:[f]},{path:"course/:id",loadComponent:()=>import("./chunk-XPW273WF.js").then(n=>n.CourseDetailComponent),canActivate:[f]},{path:"admin",loadComponent:()=>import("./chunk-OV6JS2IQ.js").then(n=>n.AdminComponent),canActivate:[O]},{path:"admin/course-management",loadComponent:()=>import("./chunk-TXDZXFNT.js").then(n=>n.CourseManagementComponent),canActivate:[O]},{path:"admin/class-rep-management",loadComponent:()=>import("./chunk-DW5KT4HC.js").then(n=>n.ClassRepManagementComponent),canActivate:[O]},{path:"profile-settings",loadComponent:()=>import("./chunk-RK7SXIPE.js").then(n=>n.ProfileSettingsComponent),canActivate:[f]},{path:"account-settings",loadComponent:()=>import("./chunk-WKNJ5QFS.js").then(n=>n.AccountSettingsComponent),canActivate:[f]},{path:"announcements",loadComponent:()=>import("./chunk-VI5FX5HD.js").then(n=>n.AnnouncementsComponent),canActivate:[f]},{path:"**",redirectTo:"/dashboard"}];var ne=(n,t)=>{let i=B(A).getAuthToken();if(!i&&n.url.includes("/logout/")&&(i=localStorage.getItem("authToken"),console.log("Auth interceptor: Found token in localStorage for logout:",i?"Yes":"No")),i){console.log("Auth interceptor: Adding Authorization header for",n.url);let o=n.clone({headers:n.headers.set("Authorization",`Token ${i}`)});return t(o)}else console.log("Auth interceptor: No token found for",n.url);return t(n)};var oe={providers:[z(),q(),Q(ie,X({scrollPositionRestoration:"top"})),$(Z([ne]))]};var me=["jitsiContainer"];function pe(n,t){n&1&&(r(0,"div",16)(1,"div",17),c(2,"div",18),r(3,"p",19),C(4,"Connecting to meeting..."),a()()())}function ge(n,t){if(n&1){let e=y();r(0,"div",16)(1,"div",20)(2,"div",21),g(),r(3,"svg",22),c(4,"path",23),a()(),_(),r(5,"h3",24),C(6,"Connection Failed"),a(),r(7,"p",25),C(8),a(),r(9,"button",26),h("click",function(){m(e);let o=d();return p(o.retryConnection())}),C(10," Try Again "),a()()()}if(n&2){let e=d();l(8),j(e.error)}}function he(n,t){n&1&&(g(),r(0,"svg",32),c(1,"path",36)(2,"path",37),a())}function ue(n,t){n&1&&(g(),r(0,"svg",32),c(1,"path",38),a())}function fe(n,t){n&1&&(g(),r(0,"svg",32),c(1,"path",39),a())}function ve(n,t){n&1&&(g(),r(0,"svg",32),c(1,"path",40),a())}function Ce(n,t){if(n&1){let e=y();r(0,"div",27)(1,"div",28)(2,"div",29)(3,"button",30),h("click",function(){m(e);let o=d();return p(o.toggleAudio())}),v(4,he,3,0,"svg",31)(5,ue,2,0,"svg",31),a(),r(6,"button",30),h("click",function(){m(e);let o=d();return p(o.toggleVideo())}),v(7,fe,2,0,"svg",31)(8,ve,2,0,"svg",31),a(),r(9,"button",30),h("click",function(){m(e);let o=d();return p(o.toggleScreenShare())}),g(),r(10,"svg",32),c(11,"path",33),a()(),_(),r(12,"button",30),h("click",function(){m(e);let o=d();return p(o.toggleChat())}),g(),r(13,"svg",32),c(14,"path",34),a()(),_(),r(15,"button",30),h("click",function(){m(e);let o=d();return p(o.toggleParticipants())}),g(),r(16,"svg",32),c(17,"path",35),a()()()()()}if(n&2){let e=d();l(3),w(e.isAudioMuted?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"),l(),u("ngIf",!e.isAudioMuted),l(),u("ngIf",e.isAudioMuted),l(),w(e.isVideoMuted?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"),l(),u("ngIf",!e.isVideoMuted),l(),u("ngIf",e.isVideoMuted),l(),w(e.isScreenSharing?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),l(3),w(e.isChatOpen?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),l(3),w(e.isParticipantsOpen?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600")}}var x=class n{constructor(t,e){this.cdr=t;this.ngZone=e}jitsiContainer;roomName="";meetingTitle="";userInfo={displayName:"User"};domain="jitsi.riverlearn.co.ke";meetingEnded=new k;participantJoined=new k;participantLeft=new k;closeRequested=new k;isLoading=!0;error=null;jitsiApi=null;cleanupTimeout=null;isAudioMuted=!1;isVideoMuted=!1;isScreenSharing=!1;isChatOpen=!1;isParticipantsOpen=!1;ngOnInit(){this.loadJitsiMeetScript(),this.setupWebSocketErrorHandler()}setupWebSocketErrorHandler(){let t=console.error;console.error=(...e)=>{let i=e.join(" ");i.includes("WebSocket connection to")&&i.includes("failed")&&(console.log("LibJitsiVideoCall: WebSocket connection failed, cleaning up"),this.cleanupAndEmitMeetingEnded()),t.apply(console,e)}}ngAfterViewInit(){}ngOnDestroy(){console.log("LibJitsiVideoCall: Component destroying, disposing API"),this.cleanupTimeout&&(clearTimeout(this.cleanupTimeout),this.cleanupTimeout=null),this.cleanupWatermarkHidingCSS(),this.cleanupAndEmitMeetingEnded()}loadJitsiMeetScript(){if(window.JitsiMeetExternalAPI){this.initializeJitsiMeet();return}let t=document.createElement("script");t.src=`https://${this.domain}/libs/external_api.min.js`,t.onload=()=>{this.initializeJitsiMeet()},t.onerror=()=>{this.error="Failed to load Jitsi Meet library",this.isLoading=!1},document.head.appendChild(t)}initializeJitsiMeet(){try{let t={roomName:this.roomName,parentNode:this.jitsiContainer.nativeElement,width:"100%",height:"100%",userInfo:{displayName:this.userInfo.displayName,email:this.userInfo.email||void 0,avatar:this.userInfo.avatar||void 0},configOverwrite:{startWithAudioMuted:!1,startWithVideoMuted:!1,enableWelcomePage:!1,prejoinPageEnabled:!1,enableClosePage:!1,enableInsecureRoomNameWarning:!1,enableNoisyMicDetection:!0,enableTalkWhileMuted:!0,enableLayerSuspension:!0,channelLastN:-1,startScreenSharing:!1,enableRemb:!0,enableTcc:!0,useRoomAsSharedDocumentName:!0,enableIceRestart:!0,useStunTurn:!0,enableOpusRed:!0,opusMaxAverageBitrate:64e3,enableRtx:!0,enableSdpSemantics:"unified-plan",enableNoAudioDetection:!0,enableLipSync:!1,enableFaceExpressions:!1,enableP2P:!1,disableThirdPartyRequests:!0,p2p:{enabled:!1,stunServers:[{urls:"stun:meet-jit-si-turnrelay.jitsi.net:443"}]},disableDeepLinking:!0,startAudioOnly:!1},interfaceConfigOverwrite:{APP_NAME:"RiverLearn",SHOW_JITSI_WATERMARK:!1,SHOW_BRAND_WATERMARK:!1,SHOW_WATERMARK_FOR_GUESTS:!1,SHOW_POWERED_BY:!1,SHOW_POLICY_WATERMARK:!1,SHOW_LOGO:!1,SHOW_BRAND:!1,SHOW_JITSI_LOGO:!1,SHOW_BRAND_LOGO:!1,SHOW_MEET_LOGO:!1,SHOW_MEET_WATERMARK:!1,SHOW_LEFT_WATERMARK:!1,SHOW_RIGHT_WATERMARK:!1,SHOW_POWERED_BY_JITSI:!1,SHOW_POWERED_BY_LOGO:!1,DISABLE_BRANDING:!0,DISABLE_WATERMARKS:!0,DISABLE_LOGO:!0,SHOW_LOBBY_BUTTON:!0,SHOW_MEETING_TIMER:!0,SHOW_DEEP_LINKING_PAGE:!1,SHOW_AUTHENTICATION_PAGE:!1,SHOW_LIVE_STREAMING_PAGE:!1,SHOW_RECORDING_PAGE:!1,SHOW_TRANSCRIPTION_PAGE:!1,SHOW_CLOSE_PAGE:!1,SHOW_WELCOME_PAGE:!1,SHOW_PREJOIN_PAGE:!1,SHOW_JOIN_PAGE:!1,SHOW_LEAVE_PAGE:!1,SHOW_ERROR_PAGE:!1,SHOW_LOADING_PAGE:!1,SHOW_SETTINGS_PAGE:!1,SHOW_ABOUT_PAGE:!1,SHOW_HELP_PAGE:!1,SHOW_FEEDBACK_PAGE:!1,SHOW_STATS_PAGE:!1,SHOW_SHORTCUTS_PAGE:!1,SHOW_KEYBOARD_SHORTCUTS_PAGE:!1,SHOW_AUDIO_SETTINGS_PAGE:!1,SHOW_VIDEO_SETTINGS_PAGE:!1,SHOW_MORE_SETTINGS_PAGE:!1,SHOW_DEVICE_SETTINGS_PAGE:!1,SHOW_NETWORK_SETTINGS_PAGE:!1,SHOW_ABOUT_DEVICE_PAGE:!1,SHOW_ABOUT_NETWORK_PAGE:!1,SHOW_ABOUT_AUDIO_PAGE:!1,SHOW_ABOUT_VIDEO_PAGE:!1,SHOW_ABOUT_MORE_PAGE:!1,SHOW_ABOUT_DEVICE_MORE_PAGE:!1,SHOW_ABOUT_NETWORK_MORE_PAGE:!1,SHOW_ABOUT_AUDIO_MORE_PAGE:!1,SHOW_ABOUT_VIDEO_MORE_PAGE:!1,SHOW_ABOUT_MORE_MORE_PAGE:!1,TOOLBAR_BUTTONS:["microphone","camera","closedcaptions","desktop","fullscreen","fodeviceselection","hangup","profile","chat","recording","livestreaming","etherpad","sharedvideo","settings","raisehand","videoquality","filmstrip","invite","feedback","stats","shortcuts","tileview","videobackgroundblur","download","help","mute-everyone"],SETTINGS_SECTIONS:["devices","language","moderator","profile","calendar","sounds","more"]}};this.jitsiApi=new window.JitsiMeetExternalAPI(this.domain,t),this.jitsiApi.addListener("videoConferenceJoined",()=>{console.log("LibJitsiVideoCall: Joined video conference"),this.isLoading=!1,this.error=null,this.hideJitsiWatermarks(),this.tryJitsiWatermarkCommands(),this.cleanupTimeout=setTimeout(()=>{if(console.log("LibJitsiVideoCall: Cleanup timeout reached, checking if still connected"),this.jitsiApi)try{let e=this.jitsiApi.getParticipantsInfo();(!e||e.length===0)&&(console.log("LibJitsiVideoCall: No participants found, cleaning up"),this.cleanupAndEmitMeetingEnded())}catch(e){console.log("LibJitsiVideoCall: Error checking participants, cleaning up:",e),this.cleanupAndEmitMeetingEnded()}},3e4)}),this.jitsiApi.addListener("participantJoined",e=>{console.log("Participant joined:",e),this.participantJoined.emit(e)}),this.jitsiApi.addListener("participantLeft",e=>{console.log("Participant left:",e),this.participantLeft.emit(e)}),this.jitsiApi.addListener("audioMuteStatusChanged",e=>{this.isAudioMuted=e.muted}),this.jitsiApi.addListener("videoMuteStatusChanged",e=>{this.isVideoMuted=e.muted}),this.jitsiApi.addListener("screenShareToggled",e=>{this.isScreenSharing=e.isSharing}),this.jitsiApi.addListener("videoConferenceLeft",()=>{console.log("LibJitsiVideoCall: videoConferenceLeft event received"),this.cleanupAndEmitMeetingEnded()}),this.jitsiApi.addListener("readyToClose",()=>{console.log("LibJitsiVideoCall: readyToClose event received"),this.cleanupAndEmitMeetingEnded()}),this.jitsiApi.addListener("hangup",()=>{console.log("LibJitsiVideoCall: hangup event received - cleaning up immediately"),setTimeout(()=>{this.cleanupAndEmitMeetingEnded()},100)}),this.jitsiApi.addListener("conferenceFailed",e=>{console.log("LibJitsiVideoCall: conferenceFailed event received:",e),this.cleanupAndEmitMeetingEnded()}),this.jitsiApi.addListener("conferenceDestroyed",e=>{console.log("LibJitsiVideoCall: conferenceDestroyed event received:",e),this.cleanupAndEmitMeetingEnded()}),this.jitsiApi.addListener("meetingEnded",()=>{console.log("LibJitsiVideoCall: meetingEnded event received (moderator ended meeting for all)"),this.cleanupAndEmitMeetingEnded()}),this.jitsiApi.addListener("toolbarButtonClicked",e=>{try{let i=e?.key??e;console.log("LibJitsiVideoCall: Toolbar button clicked:",i),i==="hangup"&&(console.log("LibJitsiVideoCall: Hangup toolbar button detected - cleaning up"),setTimeout(()=>{this.cleanupAndEmitMeetingEnded()},100))}catch(i){console.log("LibJitsiVideoCall: error handling toolbarButtonClicked",i)}}),this.jitsiApi.addListener("connectionFailed",e=>{console.log("LibJitsiVideoCall: connectionFailed event received:",e),this.cleanupAndEmitMeetingEnded()}),this.jitsiApi.addListener("error",e=>{console.log("LibJitsiVideoCall: error event received:",e),this.cleanupAndEmitMeetingEnded()})}catch(t){console.error("Failed to initialize Jitsi Meet:",t),this.error="Failed to initialize video conference",this.isLoading=!1}}toggleAudio(){this.jitsiApi&&this.jitsiApi.executeCommand("toggleAudio")}toggleVideo(){this.jitsiApi&&this.jitsiApi.executeCommand("toggleVideo")}toggleScreenShare(){this.jitsiApi&&this.jitsiApi.executeCommand("toggleShareScreen")}toggleChat(){this.jitsiApi&&this.jitsiApi.executeCommand("toggleChat")}toggleParticipants(){this.jitsiApi&&this.jitsiApi.executeCommand("toggleFilmstrip")}toggleFullscreen(){this.jitsiApi&&this.jitsiApi.executeCommand("toggleFullscreen")}leaveMeeting(){console.log("Leave meeting called"),this.jitsiApi?(console.log("LibJitsiVideoCall: Executing hangup command"),this.jitsiApi.executeCommand("hangup"),setTimeout(()=>{this.jitsiApi&&(console.log("LibJitsiVideoCall: Backup cleanup triggered - hangup event may not have fired"),this.cleanupAndEmitMeetingEnded())},2e3)):(console.log("LibJitsiVideoCall: No Jitsi API available, cleaning up immediately"),this.cleanupAndEmitMeetingEnded())}cleanupAndEmitMeetingEnded(){console.log("LibJitsiVideoCall: Cleaning up and emitting meeting ended"),this.ngZone.run(()=>{if(this.cleanupTimeout&&(clearTimeout(this.cleanupTimeout),this.cleanupTimeout=null),this.jitsiApi){try{this.jitsiApi.dispose()}catch(t){console.warn("Error disposing Jitsi API:",t)}this.jitsiApi=null}this.isLoading=!1,this.error=null,this.isAudioMuted=!1,this.isVideoMuted=!1,this.isScreenSharing=!1,this.isChatOpen=!1,this.isParticipantsOpen=!1,this.cdr.detectChanges(),this.meetingEnded.emit()})}retryConnection(){this.isLoading=!0,this.error=null,this.initializeJitsiMeet()}onCloseRequested(){console.log("LibJitsiVideoCall: Close requested from overlay"),this.leaveMeeting(),this.closeRequested.emit()}forceClose(){console.log("LibJitsiVideoCall: Force closing call"),this.cleanupAndEmitMeetingEnded()}hideJitsiWatermarks(){console.log("LibJitsiVideoCall: Hiding Jitsi watermarks"),this.injectWatermarkHidingCSS(),this.tryInjectIframeCSS(),this.setupWatermarkObserver(),setTimeout(()=>{this.hideWatermarkElements()},1e3);let t=setInterval(()=>{this.hideWatermarkElements(),this.tryInjectIframeCSS(),this.tryOverlayWatermarks(),this.tryInterceptWatermarkCreation()},2e3);setTimeout(()=>{clearInterval(t)},3e4)}injectWatermarkHidingCSS(){let t="jitsi-watermark-hider",e=document.getElementById(t);e&&e.remove();let i=document.createElement("style");i.id=t,i.textContent=this.getWatermarkHidingCSS(),document.head.appendChild(i)}setupWatermarkObserver(){let t=this.jitsiContainer?.nativeElement;if(!t)return;let e=new MutationObserver(i=>{i.forEach(o=>{o.type==="childList"&&o.addedNodes.forEach(s=>{s.nodeType===Node.ELEMENT_NODE&&this.hideWatermarkInElement(s)})})});e.observe(t,{childList:!0,subtree:!0}),setTimeout(()=>{e.disconnect()},3e4)}hideWatermarkInElement(t){let e=[".watermark",".leftwatermark",".rightwatermark",".poweredby",".powered-by",".jitsi-watermark",".jitsi-logo",".jitsi-brand",".brand-watermark",".brand-logo",".meet-logo",".meet-watermark",'[class*="watermark"]','[class*="logo"]','[class*="brand"]','[class*="powered"]','[id*="watermark"]','[id*="logo"]','[id*="brand"]','[id*="powered"]'];e.forEach(i=>{t.querySelectorAll(i).forEach(s=>{this.hideElement(s)})}),e.forEach(i=>{t.matches(i)&&this.hideElement(t)})}hideWatermarkElements(){let t=this.jitsiContainer?.nativeElement;if(!t)return;[".watermark",".leftwatermark",".rightwatermark",".poweredby",".powered-by",".jitsi-watermark",".jitsi-logo",".jitsi-brand",".brand-watermark",".brand-logo",".meet-logo",".meet-watermark",'[class*="watermark"]','[class*="logo"]','[class*="brand"]','[class*="powered"]','[id*="watermark"]','[id*="logo"]','[id*="brand"]','[id*="powered"]',"a.watermark.leftwatermark",'a[class*="watermark"]','a[class*="logo"]','a[class*="brand"]','a[class*="powered"]'].forEach(i=>{t.querySelectorAll(i).forEach(s=>{this.hideElement(s)})}),this.hideSpecificWatermarkElement(t)}hideSpecificWatermarkElement(t){let e=t.querySelector('a[aria-label*="Jitsi Meet Logo"]');e&&(console.log("LibJitsiVideoCall: Found specific Jitsi watermark element, hiding it"),this.hideElement(e)),t.querySelectorAll('a[href*="jitsi.org"]').forEach(s=>{(s.classList.contains("watermark")||s.classList.contains("leftwatermark"))&&(console.log("LibJitsiVideoCall: Found Jitsi.org watermark link, hiding it"),this.hideElement(s))}),t.querySelectorAll('[style*="watermark.svg"]').forEach(s=>{console.log("LibJitsiVideoCall: Found watermark.svg element, hiding it"),this.hideElement(s)})}hideElement(t){if(t){if(this.isWatermarkElement(t)){console.log("LibJitsiVideoCall: Removing watermark element from DOM:",t),t.remove();return}t.style.setProperty("display","none","important"),t.style.setProperty("visibility","hidden","important"),t.style.setProperty("opacity","0","important"),t.style.setProperty("width","0","important"),t.style.setProperty("height","0","important"),t.style.setProperty("position","absolute","important"),t.style.setProperty("left","-9999px","important"),t.style.setProperty("top","-9999px","important"),t.style.setProperty("z-index","-1","important"),t.style.setProperty("pointer-events","none","important"),t.style.setProperty("background","none","important"),t.style.setProperty("background-image","none","important"),t.style.setProperty("transform","scale(0)","important"),t.style.setProperty("clip-path","inset(100%)","important")}}isWatermarkElement(t){let e=t.classList,i=e.contains("watermark")||e.contains("leftwatermark")||e.contains("rightwatermark")||e.contains("jitsi-watermark")||e.contains("brand-watermark")||e.contains("meet-watermark"),o=Array.from(e).some(G=>G.includes("watermark")||G.includes("logo")||G.includes("brand")),s=t.getAttribute("aria-label")?.includes("Jitsi Meet Logo")||!1,ae=t.getAttribute("href")?.includes("jitsi.org")||!1,se=t.getAttribute("style")?.includes("watermark.svg")||!1;return i||o||s||ae||se}tryInjectIframeCSS(){try{let t=this.jitsiContainer?.nativeElement;if(!t)return;let e=t.querySelector("iframe");if(!e)return;try{let i=e.contentDocument||e.contentWindow?.document;i&&this.injectCSSIntoDocument(i)}catch{console.log("LibJitsiVideoCall: Cannot access iframe content due to CORS")}try{e.contentWindow?.postMessage({type:"HIDE_WATERMARKS",css:this.getWatermarkHidingCSS()},"*")}catch{console.log("LibJitsiVideoCall: Cannot post message to iframe")}}catch(t){console.log("LibJitsiVideoCall: Error trying to inject iframe CSS:",t)}}injectCSSIntoDocument(t){let e="jitsi-watermark-hider-iframe",i=t.getElementById(e);i&&i.remove();let o=t.createElement("style");o.id=e,o.textContent=this.getWatermarkHidingCSS(),t.head.appendChild(o)}getWatermarkHidingCSS(){return`
      /* Hide all possible Jitsi watermarks - with maximum specificity */
      .watermark,
      .leftwatermark,
      .rightwatermark,
      .poweredby,
      .powered-by,
      .jitsi-watermark,
      .jitsi-logo,
      .jitsi-brand,
      .brand-watermark,
      .brand-logo,
      .meet-logo,
      .meet-watermark,
      [class*="watermark"],
      [class*="logo"],
      [class*="brand"],
      [class*="powered"],
      [id*="watermark"],
      [id*="logo"],
      [id*="brand"],
      [id*="powered"],
      .videocontainer .watermark,
      .videocontainer .leftwatermark,
      .videocontainer .rightwatermark,
      .videocontainer .poweredby,
      .videocontainer .jitsi-watermark,
      .videocontainer .jitsi-logo,
      .videocontainer .brand-watermark,
      .videocontainer .brand-logo,
      .videocontainer .meet-logo,
      .videocontainer .meet-watermark,
      /* Additional selectors for newer Jitsi versions */
      .leftwatermark,
      .rightwatermark,
      .watermark,
      .poweredby,
      .jitsi-watermark,
      .jitsi-logo,
      .brand-watermark,
      .brand-logo,
      .meet-logo,
      .meet-watermark,
      /* More specific selectors */
      div[class*="watermark"],
      div[class*="logo"],
      div[class*="brand"],
      div[class*="powered"],
      span[class*="watermark"],
      span[class*="logo"],
      span[class*="brand"],
      span[class*="powered"],
      img[class*="watermark"],
      img[class*="logo"],
      img[class*="brand"],
      img[class*="powered"],
      /* Target the specific watermark element we found */
      a.watermark.leftwatermark,
      a[class*="watermark"],
      a[class*="logo"],
      a[class*="brand"],
      a[class*="powered"],
      /* Target elements with inline styles */
      [style*="visibility: visible"][class*="watermark"],
      [style*="visibility: visible"][class*="logo"],
      [style*="visibility: visible"][class*="brand"],
      [style*="visibility: visible"][class*="powered"] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        width: 0 !important;
        height: 0 !important;
        position: absolute !important;
        left: -9999px !important;
        top: -9999px !important;
        z-index: -1 !important;
        pointer-events: none !important;
        transform: scale(0) !important;
        clip-path: inset(100%) !important;
        clip: rect(0, 0, 0, 0) !important;
        background: none !important;
        background-image: none !important;
      }
    `}tryOverlayWatermarks(){try{let t=this.jitsiContainer?.nativeElement;if(!t||!t.querySelector("iframe"))return;let i="jitsi-watermark-overlay",o=document.getElementById(i);o||(o=document.createElement("div"),o.id=i,o.style.cssText=`
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          z-index: 1000;
          background: transparent;
        `,t.style.position="relative",t.appendChild(o)),this.createWatermarkOverlays(o),this.createFullScreenOverlay(o)}catch(t){console.log("LibJitsiVideoCall: Error creating watermark overlays:",t)}}createFullScreenOverlay(t){let e="jitsi-fullscreen-watermark-overlay",i=document.getElementById(e);i||(i=document.createElement("div"),i.id=e,i.style.cssText=`
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1002;
        background: linear-gradient(
          to bottom,
          rgba(0, 0, 0, 0.1) 0%,
          transparent 10%,
          transparent 90%,
          rgba(0, 0, 0, 0.1) 100%
        );
      `,t.appendChild(i))}createWatermarkOverlays(t){[{id:"watermark-overlay-top-left",top:"0px",left:"0px",width:"200px",height:"60px"},{id:"watermark-overlay-top-right",top:"0px",right:"0px",width:"200px",height:"60px"},{id:"watermark-overlay-bottom-left",bottom:"0px",left:"0px",width:"200px",height:"60px"},{id:"watermark-overlay-bottom-right",bottom:"0px",right:"0px",width:"200px",height:"60px"},{id:"watermark-overlay-center-bottom",bottom:"0px",left:"50%",transform:"translateX(-50%)",width:"300px",height:"60px"},{id:"watermark-overlay-top-center",top:"0px",left:"50%",transform:"translateX(-50%)",width:"300px",height:"60px"},{id:"watermark-overlay-left-center",top:"50%",left:"0px",transform:"translateY(-50%)",width:"200px",height:"60px"},{id:"watermark-overlay-right-center",top:"50%",right:"0px",transform:"translateY(-50%)",width:"200px",height:"60px"}].forEach(i=>{let o=document.getElementById(i.id);o||(o=document.createElement("div"),o.id=i.id,o.style.cssText=`
          position: absolute;
          background: rgba(0, 0, 0, 0.9);
          border-radius: 0px;
          pointer-events: none;
          z-index: 1001;
          ${i.top?`top: ${i.top};`:""}
          ${i.bottom?`bottom: ${i.bottom};`:""}
          ${i.left?`left: ${i.left};`:""}
          ${i.right?`right: ${i.right};`:""}
          ${i.width?`width: ${i.width};`:""}
          ${i.height?`height: ${i.height};`:""}
          ${i.transform?`transform: ${i.transform};`:""}
        `,t.appendChild(o))})}tryInterceptWatermarkCreation(){try{let t=this.jitsiContainer?.nativeElement;if(!t)return;let e=t.querySelector("iframe");if(!e)return;if(e.contentWindow)try{e.contentWindow.eval(`
            (function() {
              // Hide watermarks immediately
              function hideWatermarks() {
                const selectors = [
                  'a.watermark.leftwatermark',
                  'a[aria-label*="Jitsi Meet Logo"]',
                  'a[href*="jitsi.org"]',
                  '[style*="watermark.svg"]',
                  '.watermark',
                  '.leftwatermark',
                  '.rightwatermark'
                ];
                
                selectors.forEach(selector => {
                  const elements = document.querySelectorAll(selector);
                  elements.forEach(el => {
                    el.style.display = 'none';
                    el.style.visibility = 'hidden';
                    el.style.opacity = '0';
                    el.remove();
                  });
                });
              }
              
              // Hide watermarks immediately and on DOM changes
              hideWatermarks();
              setInterval(hideWatermarks, 1000);
              
              // Also listen for DOM changes
              const observer = new MutationObserver(hideWatermarks);
              observer.observe(document.body, { childList: true, subtree: true });
            })();
          `)}catch{console.log("LibJitsiVideoCall: Cannot inject script into iframe due to CORS")}}catch(t){console.log("LibJitsiVideoCall: Error intercepting watermark creation:",t)}}tryJitsiWatermarkCommands(){if(this.jitsiApi)try{["toggleWatermark","hideWatermark","hideBranding","hideLogo","disableWatermark","disableBranding","disableLogo","toggleBranding","toggleLogo"].forEach(e=>{try{this.jitsiApi.executeCommand(e),console.log(`LibJitsiVideoCall: Executed command: ${e}`)}catch{}}),setTimeout(()=>{try{this.jitsiApi.executeCommand("setInterfaceConfig",{SHOW_JITSI_WATERMARK:!1,SHOW_BRAND_WATERMARK:!1,SHOW_WATERMARK_FOR_GUESTS:!1,SHOW_POWERED_BY:!1,SHOW_POLICY_WATERMARK:!1,SHOW_LOGO:!1,SHOW_BRAND:!1,SHOW_JITSI_LOGO:!1,SHOW_BRAND_LOGO:!1,SHOW_MEET_LOGO:!1,SHOW_MEET_WATERMARK:!1,SHOW_LEFT_WATERMARK:!1,SHOW_RIGHT_WATERMARK:!1,SHOW_POWERED_BY_JITSI:!1,SHOW_POWERED_BY_LOGO:!1,DISABLE_BRANDING:!0,DISABLE_WATERMARKS:!0,DISABLE_LOGO:!0}),console.log("LibJitsiVideoCall: Set interface config to hide watermarks")}catch(e){console.log("LibJitsiVideoCall: Could not set interface config:",e)}},2e3)}catch(t){console.log("LibJitsiVideoCall: Error executing watermark commands:",t)}}cleanupWatermarkHidingCSS(){let e=document.getElementById("jitsi-watermark-hider");e&&e.remove(),["jitsi-watermark-overlay","jitsi-fullscreen-watermark-overlay","watermark-overlay-top-left","watermark-overlay-top-right","watermark-overlay-bottom-left","watermark-overlay-bottom-right","watermark-overlay-center-bottom","watermark-overlay-top-center","watermark-overlay-left-center","watermark-overlay-right-center"].forEach(o=>{let s=document.getElementById(o);s&&s.remove()})}static \u0275fac=function(e){return new(e||n)(b(V),b(L))};static \u0275cmp=S({type:n,selectors:[["app-lib-jitsi-video-call"]],viewQuery:function(e,i){if(e&1&&T(me,7),e&2){let o;I(o=W())&&(i.jitsiContainer=o.first)}},inputs:{roomName:"roomName",meetingTitle:"meetingTitle",userInfo:"userInfo",domain:"domain"},outputs:{meetingEnded:"meetingEnded",participantJoined:"participantJoined",participantLeft:"participantLeft",closeRequested:"closeRequested"},decls:21,vars:7,consts:[["jitsiContainer",""],[1,"min-h-screen","bg-gray-50","flex","flex-col"],[1,"bg-white","border-b","border-gray-200","px-6","py-4"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","space-x-4"],["src","/courseorganizerlogo.png","alt","RiverLearn Logo",1,"h-8","w-auto"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","space-x-3"],[1,"p-2","text-gray-600","hover:text-gray-900","hover:bg-gray-100","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"],[1,"px-4","py-2","bg-red-600","hover:bg-red-700","text-white","rounded-lg","font-medium","transition-colors",3,"click"],["class","flex-1 flex items-center justify-center",4,"ngIf"],[1,"flex-1","relative"],["class","absolute bottom-6 left-1/2 transform -translate-x-1/2 z-10",4,"ngIf"],[1,"flex-1","flex","items-center","justify-center"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-600","mx-auto","mb-4"],[1,"text-gray-600"],[1,"text-center","max-w-md"],[1,"mx-auto","flex","items-center","justify-center","h-16","w-16","rounded-full","bg-red-100","mb-4"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-8","w-8","text-red-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600","mb-4"],[1,"px-4","py-2","bg-blue-600","hover:bg-blue-700","text-white","rounded-lg","font-medium","transition-colors",3,"click"],[1,"absolute","bottom-6","left-1/2","transform","-translate-x-1/2","z-10"],[1,"bg-white/95","backdrop-blur-sm","border","border-gray-200","rounded-2xl","px-4","py-2","shadow-lg"],[1,"flex","items-center","space-x-2"],[1,"p-3","rounded-xl","hover:bg-opacity-80","transition-colors",3,"click"],["class","w-5 h-5","fill","currentColor","viewBox","0 0 24 24",4,"ngIf"],["fill","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["d","M20 18c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2h-4zM4 6h16v10H4V6z"],["d","M20 2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h4l4 4 4-4h4c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z"],["d","M16 4c0-1.11.89-2 2-2s2 .89 2 2-.89 2-2 2-2-.89-2-2zm4 18v-6h2.5l-2.54-7.63A1.5 1.5 0 0 0 18.54 8H17c-.8 0-1.54.37-2.01.99L14 10.5 12.01 8.99A2.5 2.5 0 0 0 10 8H8.46c-.8 0-1.54.37-2.01.99L4 10.5 2.01 8.99A2.5 2.5 0 0 0 0 8v10h2v6h4v-6h2v6h4v-6h2v6h4z"],["d","M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"],["d","M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"],["d","M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27 6.73 8H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3z"],["d","M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"],["d","M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.55-.18L19.73 21 21 19.73 3.27 2zM5 16V8h1.73l8 8H5z"]],template:function(e,i){if(e&1){let o=y();r(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),c(4,"img",5),r(5,"div")(6,"h1",6),C(7),a(),r(8,"p",7),C(9),a()()(),r(10,"div",8)(11,"button",9),h("click",function(){return m(o),p(i.toggleFullscreen())}),g(),r(12,"svg",10),c(13,"path",11),a()(),_(),r(14,"button",12),h("click",function(){return m(o),p(i.leaveMeeting())}),C(15," Leave Meeting "),a()()()(),v(16,pe,5,0,"div",13)(17,ge,11,1,"div",13),c(18,"div",14,0),v(20,Ce,18,14,"div",15),a()}e&2&&(l(7),j(i.meetingTitle||"Video Meeting"),l(2),j(i.roomName),l(7),u("ngIf",i.isLoading),l(),u("ngIf",i.error),l(),U("hidden",i.isLoading||i.error),l(2),u("ngIf",!i.isLoading&&!i.error))},dependencies:[R,P,ee],styles:["[_nghost-%COMP%]{display:block;height:100vh}.hidden[_ngcontent-%COMP%]{display:none!important}[_nghost-%COMP%]     .watermark, [_nghost-%COMP%]     .leftwatermark, [_nghost-%COMP%]     .rightwatermark, [_nghost-%COMP%]     .poweredby, [_nghost-%COMP%]     .powered-by, [_nghost-%COMP%]     .jitsi-watermark, [_nghost-%COMP%]     .jitsi-logo, [_nghost-%COMP%]     .jitsi-brand, [_nghost-%COMP%]     .brand-watermark, [_nghost-%COMP%]     .brand-logo, [_nghost-%COMP%]     .meet-logo, [_nghost-%COMP%]     .meet-watermark, [_nghost-%COMP%]     [class*=watermark], [_nghost-%COMP%]     [class*=logo], [_nghost-%COMP%]     [class*=brand], [_nghost-%COMP%]     [class*=powered], [_nghost-%COMP%]     [id*=watermark], [_nghost-%COMP%]     [id*=logo], [_nghost-%COMP%]     [id*=brand], [_nghost-%COMP%]     [id*=powered]{display:none!important;visibility:hidden!important;opacity:0!important;width:0!important;height:0!important;position:absolute!important;left:-9999px!important;top:-9999px!important;z-index:-1!important}[_nghost-%COMP%]     iframe{position:relative}[_nghost-%COMP%]     .videocontainer .watermark, [_nghost-%COMP%]     .videocontainer .leftwatermark, [_nghost-%COMP%]     .videocontainer .rightwatermark, [_nghost-%COMP%]     .videocontainer .poweredby, [_nghost-%COMP%]     .videocontainer .jitsi-watermark, [_nghost-%COMP%]     .videocontainer .jitsi-logo, [_nghost-%COMP%]     .videocontainer .brand-watermark, [_nghost-%COMP%]     .videocontainer .brand-logo, [_nghost-%COMP%]     .videocontainer .meet-logo, [_nghost-%COMP%]     .videocontainer .meet-watermark{display:none!important;visibility:hidden!important;opacity:0!important;width:0!important;height:0!important;position:absolute!important;left:-9999px!important;top:-9999px!important;z-index:-1!important}"]})};function _e(n,t){if(n&1){let e=y();r(0,"app-lib-jitsi-video-call",11,0),h("meetingEnded",function(){m(e);let o=d(2);return p(o.onMeetingEnded())})("closeRequested",function(){m(e);let o=d(2);return p(o.onCloseRequested())}),a()}if(n&2){let e=d(2);u("roomName",e.callData.roomName)("meetingTitle",e.callData.meetingTitle)("userInfo",e.callData.userInfo)}}function be(n,t){if(n&1){let e=y();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"button",5),h("click",function(){m(e);let o=d();return p(o.forceClose())}),g(),r(4,"svg",6),c(5,"path",7),a()(),_(),r(6,"button",8),h("click",function(){m(e);let o=d();return p(o.endCall())}),g(),r(7,"svg",6),c(8,"path",9),a()()(),v(9,_e,2,3,"app-lib-jitsi-video-call",10),a()()}if(n&2){let e=d();l(9),u("ngIf",e.callData)}}var D=class n{constructor(t,e,i){this.libJitsiCallService=t;this.cdr=e;this.ngZone=i}jitsiComponent;isCallActive=!1;callData=null;subscriptions=[];ngOnInit(){console.log("CallOverlayComponent: Initializing"),this.subscriptions.push(this.libJitsiCallService.isCallActive$.subscribe(t=>{console.log("CallOverlayComponent: isCallActive changed to:",t),this.ngZone.run(()=>{this.isCallActive=t,this.cdr.detectChanges()})})),this.subscriptions.push(this.libJitsiCallService.callData$.subscribe(t=>{console.log("CallOverlayComponent: callData changed to:",t),this.ngZone.run(()=>{this.callData=t,this.cdr.detectChanges()})}))}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}endCall(){console.log("CallOverlayComponent: endCall() called"),this.jitsiComponent&&(console.log("CallOverlayComponent: Calling leaveMeeting on Jitsi component"),this.jitsiComponent.leaveMeeting()),this.ngZone.run(()=>{this.libJitsiCallService.endCall(),this.cdr.detectChanges()})}onMeetingEnded(){console.log("Meeting ended, closing overlay"),this.ngZone.run(()=>{this.libJitsiCallService.endCall(),this.cdr.detectChanges()})}onCloseRequested(){console.log("Close requested, closing overlay"),this.ngZone.run(()=>{this.libJitsiCallService.endCall(),this.cdr.detectChanges()})}forceClose(){console.log("Force close requested, immediately closing overlay"),this.ngZone.run(()=>{this.jitsiComponent&&(console.log("CallOverlayComponent: Calling forceClose on Jitsi component"),this.jitsiComponent.forceClose()),this.libJitsiCallService.endCall(),this.cdr.detectChanges()})}static \u0275fac=function(e){return new(e||n)(b(te),b(V),b(L))};static \u0275cmp=S({type:n,selectors:[["app-call-overlay"]],viewQuery:function(e,i){if(e&1&&T(x,5),e&2){let o;I(o=W())&&(i.jitsiComponent=o.first)}},decls:1,vars:1,consts:[["jitsiComponent",""],["class","fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center",4,"ngIf"],[1,"fixed","inset-0","z-50","bg-black","bg-opacity-50","flex","items-center","justify-center"],[1,"bg-white","rounded-2xl","shadow-2xl","w-full","h-full","max-w-7xl","max-h-full","overflow-hidden"],[1,"absolute","top-4","right-4","z-10","flex","space-x-2"],["title","Force Close (Debug)",1,"p-2","bg-yellow-600","hover:bg-yellow-700","text-white","rounded-full","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"],[1,"p-2","bg-red-600","hover:bg-red-700","text-white","rounded-full","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[3,"roomName","meetingTitle","userInfo","meetingEnded","closeRequested",4,"ngIf"],[3,"meetingEnded","closeRequested","roomName","meetingTitle","userInfo"]],template:function(e,i){e&1&&v(0,be,10,1,"div",1),e&2&&u("ngIf",i.isCallActive)},dependencies:[R,P,x],styles:["[_nghost-%COMP%]{display:block}"]})};var N=class n{title=F("course-organizer");static \u0275fac=function(e){return new(e||n)};static \u0275cmp=S({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(e,i){e&1&&c(0,"router-outlet")(1,"app-call-overlay")},dependencies:[Y,D],encapsulation:2})};K(N,oe).catch(n=>console.error(n));
